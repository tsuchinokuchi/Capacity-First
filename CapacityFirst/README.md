# タスク管理テンプレート インストールガイド

このテンプレートを使用していただきありがとうございます。
このシステムをあなたのObsidian環境で動作させるための手順を説明します。

## 1. 必須プラグインの導入

このテンプレートは、Obsidianのコミュニティプラグインを使用して動作します。
「設定 > コミュニティプラグイン」から以下のプラグインを検索し、インストール・有効化してください。

| プラグイン名 | 必須 | 用途 |
| :--- | :---: | :--- |
| **Dataview** | ✅ | ダッシュボード表示、データ集計に必須です。 |
| **QuickAdd** | ✅ | ボタン動作、タスク自動化スクリプトの実行に必須です。 |
| **Buttons** | ✅ | 画面上の「タスク追加」などのボタンを表示するために必要です。 |
| **Tasks** | (推奨) | チェックボックスの操作性を向上させたい場合に推奨します。 |

## 2. プラグインの設定

### Dataview の設定
1.  設定画面から `Dataview` を開きます。
2.  **Enable JavaScript Queries** を **ON** にします（必須）。
3.  **Enable Inline JavaScript Queries** を **ON** にします（必須）。
    *   *注意: これらを有効にしないと、スクリプトが動かず画面がエラーになります。*

### QuickAdd の設定

QuickAddには、タスク管理用の「マクロ」を登録する必要があります。
あなたの状況に合わせて、AまたはBの方法を選んでください。

#### 【A】 QuickAddを初めて使う方（簡単）
同梱の `quickadd_settings.json` を使用して、設定を一括インポートします。
*注意: 既存のQuickAdd設定がある場合、この操作で上書きされて消えてしまうので、【B】を選んでください。*

1.  Obsidianを終了します。
2.  あなたのボールトフォルダ内の `.obsidian/plugins/quickadd/` フォルダを開きます。
3.  `data.json` というファイルがあればバックアップを取った上で、同梱の `quickadd_settings.json` を `data.json` にリネームして上書きします。
4.  Obsidianを起動します。

#### 【B】 すでにQuickAddを使っている方（手動設定）
設定画面から `QuickAdd` を開き、以下の手順でマクロを一つずつ登録してください。

**登録手順:**
1.  `Manage Macros` ボタンを押します。
2.  `Add macro` 欄に **マクロ名** を入力して `Add` します。
3.  追加されたマクロの `Configure` ボタンを押します。
4.  `User Scripts` 欄から、対応するスクリプトファイルを選択して `Add` します。
5.  トップページに戻り、`Choices` 欄に同じ名前を入力し、タイプを `Macro` にして `Add Choice` します。
6.  追加されたChoiceの `⚙️`（設定）を押し、先ほど作ったマクロを紐付けます。

**登録リスト:**

| マクロ名 / Choice名 | 対応スクリプトファイル |
| :--- | :--- |
| **タスク追加** | `scripts/タスク追加.js` |
| **タスク移動** | `scripts/タスク移動.js` |
| **タスク削除** | `scripts/タスク削除.js` |
| **タスク完了** | `scripts/タスク完了.js` |
| **タスクプールからスケジュールに移動** | `scripts/タスクプールからスケジュールに移動.js` |
| **タスクプールへ移動** | `scripts/タスクプールへ移動.js` |
| **繰り返しタスク展開** | `scripts/繰り返しタスク展開.js` |
| **繰り返しタスク追加** | `scripts/繰り返しタスク追加.js` |
| **容量チェック** | `scripts/容量チェック.js` |
| **プロジェクト作成** | `scripts/プロジェクト作成.js` |
| **サブタスク追加** | `scripts/サブタスク追加.js` |
| **サブタスク展開** | `scripts/サブタスク展開.js` |
| **進捗更新** | `scripts/進捗更新.js` |
| **年間スケジュール作成** | `scripts/actions/create_year_schedule.js` |

## 3. ファイルの配置

ダウンロードした以下のフォルダ/ファイルを、**あなたのボールトのルート（一番上の階層）にコピーしてください。**
※ `scripts` フォルダがルートにないと、スクリプトが正しく動作しません。

*   `scripts/` （フォルダごと） → ボールト直下へ
*   `テンプレート/` （フォルダごと） → ボールト直下へ
*   `config/` （フォルダごと） → ボールト直下へ
*   `タスク管理ダッシュボード.md`
*   `スケジュールテンプレート.md`
*   `ジャンル設定.md`


※ `scripts/config.js` を開いて、フォルダパス設定などを環境に合わせて変更することも可能です（通常はそのままで動きます）。

## 4. 機能ガイドと使い方

このシステムは、タスク管理を効率化するための以下の機能を備えています。

### 💡 スムーズな日付入力
「タスク追加」や「プロジェクト作成」などで日付を入力する際、柔軟なフォーマットが使用可能です。
わざわざ `2025-12-24` と打つ必要はありません。

*   **`12-24`** → 今年の（または来年の）12月24日に自動変換
*   **`1-5`** → 今年の（または来年の）1月5日に自動変換
*   **空欄** → 「今日」または「指定なし」として扱われます

### 🔄 繰り返しタスク（ルーチンワーク）
毎日、毎週、毎月のルーチンワークを全自動でスケジュールに展開できます。

1.  **設定方法**:
    以下のフォルダにあるファイルを開き、ルールに従ってタスクを記述します。
    *   **毎日**: `スケジュール/繰り返しタスク/毎日/毎日.md`
    *   **毎週**: `スケジュール/繰り返しタスク/毎週/毎週.md`
    *   **毎月**: `スケジュール/繰り返しタスク/毎月/毎月.md`
2.  **展開方法**:
    ダッシュボード下部の **「🔄 繰り返しタスク展開」** ボタンを押します。
    「今週」「来週」などの期間を選ぶと、対応する日付にタスクが一括で作成されます。
    *※ 重複防止機能により、ボタンを何度押しても同じタスクが増殖することはありません。*

### 🗂 タスクプール（Someday / 未定）
「いつやるか決まっていない」「一旦退避させたい」タスクの管理場所です。

*   **プールに入れる**:
    ダッシュボード下部の **「📥 タスクプールへ移動」** ボタンを押し、日付の決まったタスクを選択してプールへ送ることができます。
*   **プールから戻す**:
    ダッシュボードの「🗂 タスクプール」セクションを開き、タスク横の **「日付変更」** ボタンを押すと、指定した日付のスケジュールに戻せます。

### 🚀 高度なプロジェクト管理
プロジェクトごとに専用のノートを作成し、進捗を可視化します。

*   **作成**: ダッシュボード下部の **「プロジェクト作成」** ボタンから。
*   **管理**:
    プロジェクトノート内に **「➕ サブタスク追加」** ボタンがあり、その場でタスクを追加できます。
    追加したタスクは自動的にデイリーのスケジュールにも反映（リンク）されます。
*   **進捗**:
    タスクを完了すると、プロジェクトノート上部の進捗バーが自動更新されます。

## 5. 1日の容量（キャパシティ）の設定

デフォルトでは、1日のタスク容量の上限は **360分（6時間）** に設定されています。
あなたの毎日の作業可能時間に合わせて、この値を変更できます。

1.  `config/settings.json` を開きます。
2.  `maxDailyMinutes` の数値を変更します（単位：分）。

```json
{
    "maxDailyMinutes": 480  // 例: 8時間にする場合
}
```

---
セットアップは以上です。
`タスク管理ダッシュボード.md` を開いて、画面が表示されれば成功です！

## (上級者向け) フォルダ構成のカスタマイズ

もし `CapacityFirst` というフォルダ名を変更したい場合や、構成を変えたい場合は、設定ファイルの変更が必要です。

1.  `scripts/config.js` を開きます。
2.  `BASE_PATH` の値を、あなたの変更したフォルダ名に合わせて書き換えてください。

```javascript
// 例: フォルダ名を "MyTaskSystem" に変えた場合
const BASE_PATH = "MyTaskSystem";
```

※ 正しく設定しないと、スクリプトがファイルを見つけられずにエラーになります。

## (応用) ダッシュボードパーツの埋め込み

ダッシュボードの各パーツ（「今日のタスク」や「プロジェクト進捗」など）は、個別に他のノート（デイリーノートなど）に埋め込むことができます。
自分好みのダッシュボードを作りたい場合や、デイリーノートにタスクリストを表示したい場合に活用してください。

### 埋め込み用コード

DataviewJSのコードブロックを作成し、以下のコードを記述してください。
`ROOT` の値は、あなたのフォルダ構成に合わせて変更してください（標準構成なら `"CapacityFirst"`）。

```dataviewjs
// 設定: スクリプトの親フォルダ名
const ROOT = "CapacityFirst"; 

// 設定ファイルの読み込み
// ※パスは環境に合わせて調整が必要な場合があります
const configPath = app.vault.adapter.basePath + "/" + (ROOT ? ROOT + "/" : "") + "scripts/config.js";
const config = require(configPath);

// 埋め込みたいパーツのパスを指定して表示
// 第2引数に config と root を渡すのがポイントです
await dv.view((ROOT ? ROOT + "/" : "") + "scripts/dashboard/today_tasks", { config: config, root: ROOT });
```

### 利用可能なパーツ一覧

上記の `scripts/dashboard/today_tasks` の部分を、以下のように書き換えることで各パーツを表示できます。

| パーツ名 | パス (書き換える部分) | 用途 |
| :--- | :--- | :--- |
| **今日のタスク** | `scripts/dashboard/today_tasks` | 今日のタスク一覧と操作ボタンを表示します。 |
| **明日のタスク** | `scripts/dashboard/tomorrow_tasks` | 明日の予定タスクを表示します。 |
| **タスクプール** | `scripts/dashboard/task_pool` | 期限切れタスクと、プール（いつかやる）タスクを表示します。 |
| **プロジェクト進捗** | `scripts/dashboard/project_list` | 進行中のプロジェクトと進捗バーを表示します。 |
| **今週のサマリー** | `scripts/dashboard/weekly_summary` | 今週のタスク完了数や時間の集計を表示します。 |
| **キャパシティ** | `scripts/dashboard/capacity` | 今日の残り時間（見積もり時間 vs 稼働可能時間）を表示します。 |

