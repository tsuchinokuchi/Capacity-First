# QuickAdd Macros 設定手順

このフォルダには、タスク管理システム用のQuickAdd Macroが含まれています。

## インストール方法

### 1. QuickAddの設定画面を開く
1. Obsidianの設定を開く
2. 「QuickAdd」を選択
3. 「Macro Manager」をクリック

### 2. Macroを追加
1. 「Add Macro」をクリック
2. Macro名を入力（例：「タスク追加」）
3. 「Add Choice」をクリック
4. 「Type」で「Macro」を選択
5. 「Macro」で「新規作成」を選択
6. コードエディタが開く

### 3. Macroコードをコピー
1. このフォルダ内の対応する`.js`ファイルを開く
2. コード全体をコピー
3. QuickAddのコードエディタに貼り付け
4. 「Save」をクリック

### 4. MacroをChoiceに追加
1. 「Choices」で「Add Choice」をクリック
2. 「Type」で「Macro」を選択
3. 「Macro」で先ほど作成したMacroを選択
4. 「Save」をクリック

## 利用可能なMacros

### 1. タスク追加
- **ファイル**: `タスク追加.js`
- **機能**: 
  - タスク名を入力
  - 所要時間を選択（15分単位）
  - ジャンルを選択
  - 日付を選択（デフォルト：今日）
  - 容量チェック（超過時警告）
  - スケジュールファイルに自動追加

### 2. タスク移動
- **ファイル**: `タスク移動.js`
- **機能**:
  - 今日のタスクから選択
  - 次の出勤日に自動移動
  - 容量チェック（必須）
  - 超過時は警告

### 3. タスク完了
- **ファイル**: `タスク完了.js`
- **機能**:
  - 日付を選択（デフォルト：今日、空白の場合は今日）
  - 指定日の未完了タスクから選択
  - 選択したタスクを完了状態（`- [ ]` → `- [x]`）に変更

### 4. タスクプールからスケジュールに移動
- **ファイル**: `タスクプールからスケジュールに移動.js`
- **機能**:
  - タスクプールの未スケジュールタスクから選択
  - 日付を指定（デフォルト：今日）
  - 容量チェック（超過時警告）
  - スケジュールファイルに追加し、タスクプールから削除

## 使用方法

### コマンドパレットから実行
1. `Ctrl+P` (Windows) または `Cmd+P` (Mac) でコマンドパレットを開く
2. 「QuickAdd:」で始まるコマンドを検索
3. 作成したChoiceを選択

### ホットキーを設定（オプション）
1. QuickAddの設定画面で「Choices」を選択
2. 各Choiceの「Hotkey」を設定

## 注意事項

- Macroは、ObsidianのAPIを使用しているため、Obsidianのバージョンによって動作が異なる可能性があります
- 容量チェックは、リアルタイムで実行されるため、パフォーマンスに注意してください
- 出勤日リストの取得は、週勤務グリッドの実装に依存します（現在は簡易実装）

## トラブルシューティング

### Macroが動作しない場合
1. QuickAddが有効になっているか確認
2. Macroコードに構文エラーがないか確認
3. Obsidianのコンソール（`Ctrl+Shift+I`）でエラーメッセージを確認

### 容量チェックが正しく動作しない場合
1. タスクフォーマットが正しいか確認（`⏱️ 60`形式）
2. スケジュールファイルのパスが正しいか確認

