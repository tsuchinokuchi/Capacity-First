# 📋 Capacity-first 要件定義書

## 1. 基本仕様

### 1.1 タスクの基本情報
- **所要時間**: 分単位で設定
- **最小単位**: 15分
- **実施時間**: 定めない（日付のみ管理）
- **1日の容量上限**: 5時間（300分）※勤務時間のみ
- **時間管理対象**: 勤務時間のみ（プライベートは容量管理の対象外）

### 1.2 タスクの分類
- **ジャンル**: タスクごとにジャンルを設定（細かく分類）
  - 仕事系：
    - デスクワーク（資料作成、報告書など）
    - 売場作業（品出し、売場整理など）
    - 顧客対応（接客、問い合わせ対応など）
    - 定型作業（週報、月報など）
    - その他仕事
  - プライベート系：
    - 学習
    - 健康
    - 趣味
    - その他プライベート
- **ジャンルごとの容量構成比**: 可視化したい（上限設定は不要）
  - 例：デスクワーク40%、売場作業20%、顧客対応30%、定型作業10%

## 2. プロジェクト管理

### 2.1 プロジェクトの定義
- **期間**: 最大1ヶ月
- **進捗管理**: 必要（完了率、マイルストーン）
- **サブタスク**: プロジェクト内にサブタスクを定義（1階層まで）
- **展開方法**: サブタスクを日次タスクに落とし込む

### 2.2 先の予定の把握
- **期間**: 1ヶ月先まで把握したい
- **表示**: 週単位、月単位での可視化

## 3. 繰り返しタスク

### 3.1 繰り返しパターン
- **毎日**: 例：朝支度、夕食準備
- **毎週**: 例：週次MTG、週報作成
- **毎月**: 例：月次レポート、請求処理

### 3.2 例外処理
- **スキップ**: 今週だけスキップ可能
- **完了チェック**: 日付ごとに個別にチェック

## 4. タスクの移動・延期

### 4.1 移動パターン
- **基本**: 次の日に移動
- **出勤日連動**: 出勤日リストに合わせて自動割り振り（重要！）
  - 次の日が休みの場合、次の出勤日に移動
  - 週勤務グリッドと連携

### 4.2 移動時の処理
- **容量チェック**: 必須
  - 移動先の容量を確認
  - 超過時は警告または次の可能な日に提案

## 5. タスクの完了管理

### 5.1 完了状態の可視化
- **完了**: ✅
- **未完了**: ⬜
- **進捗率**: プロジェクト単位で表示

### 5.2 完了チェック
- 日付ごとに個別にチェック
- 繰り返しタスクも日付ごとにチェック

## 6. 表示・UI要件

### 6.1 表示場所
- **ダッシュボード**: PC用
- **モバイルダッシュボード**: モバイル用

### 6.2 優先的に表示したい情報
1. **今日のタスク**
   - タスク一覧
   - 容量使用状況（5時間中○時間）
   - ジャンル別の容量構成比
2. **今週のタスク**
   - 週間タスク一覧
   - 週間容量使用状況
3. **週間容量**
   - 1週間の容量使用状況
   - ジャンル別の容量構成比

### 6.3 表示項目
- タスク名
- 所要時間
- ジャンル
- プロジェクト（関連する場合）
- 完了状態
- 容量使用率

## 7. システム構成（案）

### 7.1 フォルダ構成
```
📁 タスク管理/
  ├── 📁 スケジュール/ (既存の日次スケジュール)
  │   └── YYYY-MM-DD.md
  ├── 📁 プロジェクト/ (NEW)
  │   └── プロジェクト名.md
  ├── 📁 タスクプール/ (NEW - 未スケジュールタスク)
  │   └── タスクプール.md
  ├── 📁 繰り返しタスク/ (NEW)
  │   ├── 毎日.md
  │   ├── 毎週.md
  │   └── 毎月.md
  ├── 📄 タスク管理ダッシュボード.md (NEW)
  └── 📄 週勤務グリッド.md (既存 - 出勤日リスト)
```

### 7.2 使用プラグインと役割

#### 必須プラグイン

1. **Tasks プラグイン**
   - **役割**: タスク管理の基盤
   - **機能**:
     - タスクの収集・検索
     - 繰り返しタスクの定義（`🔁 every week`）
     - 日付管理（`📅 YYYY-MM-DD`）
     - タグ管理（ジャンル、プロジェクトなど）
     - カスタムフィールド（所要時間、ジャンルなど）

2. **QuickAdd プラグイン**
   - **役割**: タスク追加の簡素化
   - **機能**:
     - ワンクリックでタスク追加
     - カスタムフォーム（所要時間、ジャンル選択）
     - タスク移動コマンド（次の日に移動）
     - 容量チェック付きタスク追加

3. **Templater プラグイン**
   - **役割**: 繰り返しタスクの自動展開、テンプレート生成
   - **機能**:
     - 週始めに繰り返しタスクを自動展開
     - 出勤日に合わせてタスクを展開
     - プロジェクトのサブタスクを日次タスクに展開

4. **Buttons プラグイン**
   - **役割**: ボタン操作
   - **機能**:
     - 「次の日に移動」ボタン
     - 「容量チェック」ボタン
     - 「タスク追加」ボタン

5. **Dataview プラグイン**（既に使用中）
   - **役割**: 可視化・集計
   - **機能**:
     - タスク一覧の表示
     - 容量使用状況の計算
     - ジャンル別容量構成比の表示

#### 推奨プラグイン（オプション）

6. **Periodic Notes プラグイン**
   - **役割**: 日次ノートの自動生成
   - **機能**: スケジュールファイルの自動作成（既存システムと統合）

## 8. 機能要件

### 8.1 タスク追加時（簡単に追加できるように）
- [ ] QuickAddでフォーム表示
- [ ] タスク名を入力
- [ ] 所要時間を設定（15分単位、ドロップダウン）
- [ ] ジャンルを選択（ドロップダウン）
- [ ] プロジェクトに関連付け（任意）
- [ ] 日付を選択（デフォルト：今日）
- [ ] 容量チェック（超過時警告）
- [ ] 自動でスケジュールファイルに追加

### 8.2 タスク移動時
- [ ] 次の日に移動（ボタン操作）
- [ ] 出勤日リストに合わせて自動割り振り
- [ ] 容量チェック（必須）
- [ ] 超過時は次の可能な日を提案

### 8.3 繰り返しタスク展開時
- [ ] 週始めに自動展開（月曜朝）
- [ ] 出勤日に合わせて展開
- [ ] 例外処理（スキップ）

### 8.4 容量管理
- [ ] 1日の容量上限チェック（5時間）
- [ ] 週間容量の可視化
- [ ] ジャンル別容量構成比の表示

### 8.5 プロジェクト管理
- [ ] サブタスクを日次タスクに展開
- [ ] 進捗率の自動計算
- [ ] 1ヶ月先までの予定を可視化

## 9. 非機能要件

### 9.1 パフォーマンス
- タスク数が増えても動作すること
- 表示が遅くならないこと

### 9.2 使いやすさ
- 操作が直感的であること
- エラー時に適切なメッセージを表示

### 9.3 拡張性
- 将来的に機能追加しやすい構造

## 10. 今後の検討事項

- [ ] タスクの優先度設定
- [ ] タスクの依存関係管理
- [ ] タスクの自動ソート（優先度、期限順など）
- [ ] タスクの検索・フィルタ機能の強化

